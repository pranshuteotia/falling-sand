(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();class C{constructor({color:t,empty:i}){this.color=t,this.empty=i}get isEmpty(){return this.empty}get getColor(){return this.color}}const g=class g extends C{constructor(){super({color:g.baseColor,empty:!0})}};g.baseColor="#fff";let f=g;class L{constructor(t){this.width=Math.floor(t.canvasWidth/t.gridCellDimension),this.height=Math.floor(t.canvasHeight/t.gridCellDimension),this.canvasContext=t.context,this.pixelDimension=t.gridCellDimension,this.grid=new Array(this.height*this.width).fill(new f),this.rowCount=Math.floor(this.grid.length/this.width)}clear(){this.grid=new Array(this.height*this.width).fill(new f)}set(t,i,n){if(t>=this.width||t<0||i>=this.height||i<0)return;const e=this.getIndex(t,i);this.grid[e]=n}setCircle(t,i,n,e=2,s=1){let c=e*e;for(let o=-e;o<=e;o++)for(let r=-e;r<=e;r++)r*r+o*o<=c&&Math.random()<s&&this.set(t+r,i+o,n())}swap(t,i){const n=this.grid[t],e=this.grid[i];this.setIndex(t,e),this.setIndex(i,n)}isEmpty(t){return t<0||t>=this.grid.length?!1:this.grid[t].isEmpty}draw(){for(let t=0;t<this.grid.length;++t){const i=this.grid[t];if(i.isEmpty)continue;const{x:n,y:e}=this.convertIndexToCoords(t);this.canvasContext.save(),this.canvasContext.fillStyle=i.getColor,this.canvasContext.fillRect(n*this.pixelDimension,e*this.pixelDimension,this.pixelDimension,this.pixelDimension),this.canvasContext.restore()}this.update()}update(){for(let t=this.rowCount-1;t>=0;--t){const i=t*this.width,n=Math.random()>.5;for(let e=0;e<this.width;++e){const s=n?e:-e-1+this.width;this.updateParticle(i+s)}}}convertIndexToCoords(t){return{x:t%this.width,y:Math.floor(t/this.width)}}updateParticle(t){const i=t+this.width,n=i-1,e=i+1;this.isEmpty(i)?this.swap(t,i):this.isEmpty(n)?this.swap(t,n):this.isEmpty(e)&&this.swap(t,e)}getIndex(t,i){return i*this.width+t}setIndex(t,i){this.grid[t]=i}}const h=class h extends C{constructor(){super({color:h.getRandomSandColor(),empty:!1})}static getRandomSandColor(){return h.SandColors[Math.floor(Math.random()*h.SandColors.length)]}};h.SandColors=["#eaba6b","#ead2ac","#f7e8a4"];let m=h;function I(){let l=!0,t=()=>new m;const i=window.innerHeight-10,n=window.innerWidth-10,e=5,s=document.querySelector("#clear"),c=document.querySelector("#pause"),o=document.querySelector("#particle");let r=!1,d={x:null,y:null};const a=document.querySelector("#canvas");a.height=i,a.width=n,a.style.backgroundColor="#000";const y=a.getContext("2d"),p=new L({context:y,canvasHeight:i,canvasWidth:n,gridCellDimension:e});function w(){l&&(y.clearRect(0,0,n,i),p.draw(),window.requestAnimationFrame(w))}o.addEventListener("pointerup",()=>{o.textContent==="Sand"?(o.textContent="Empty",t=()=>new m):(o.textContent="Sand",t=()=>new f)}),s.addEventListener("pointerup",()=>{p.clear()}),c.addEventListener("pointerup",()=>{l=!l,c.textContent=l?"Pause":"Resume",l&&w()}),a.addEventListener("pointerdown",x),a.addEventListener("pointerup",()=>r=!1),a.addEventListener("pointerout",()=>r=!1),a.addEventListener("pointermove",u=>{d={x:u.clientX,y:u.clientY}});async function x(u){if(l)for(r=!0,d.x=u.clientX,d.y=u.clientY;r;){await new Promise(S=>setTimeout(S,1e3/60));const v=Math.floor((d.x-5)/e),E=Math.floor((d.y-5)/e);p.setCircle(v,E,t,2,.5)}}w()}I();
